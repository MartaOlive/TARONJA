<html>
<head>
<script>
"use strict"

////////////////////////////////////NOVA TAULAAAAAAAAAAAAAAAAAAAAA////////////////////
var conditionsFilter=[ //valors de la taula
	{property: "A"},
	{property: "B"},
	{property: "C"},
	{property: "D"},
	{property: "E"},
	{property: "F"}
]

var elemFilter={ //estctura de la taula
	elems: [
		{
			elems: [
				{
					elems: [0, 1],
					nexus: "or"
				},
				{
					elems: [2],
					nexus: null
				},
				{
					elems: [5],
					nexus: null
				}
			],
			nexus: "and"
		},
		{
			elems: [
				{
					elems: [3, 4],
					nexus: "or"
				}
			]
		}
	],
	nexus: "or"
}

function ChangeConditionFilterTable(elem, iConNew, iConCurrent)
{
	if (typeof elem === "object")
	{
		for (var i=0; i<elem.elems.length; i++)
			if (ChangeConditionFilterTable(elem.elems[i], iConNew, iConCurrent))
				elem.elems[i]=iConNew;
	}
	else
	{
		if (elem==iConCurrent)
			return true //doIt
	}
	return false;
}

function MoveDownFilterCondition(iCon)
{
	alert(GiveNextConditionNextBoxFilterTable(elemFilter, iCon));	
}

function GiveNextConditionNextBoxFilterTable(elem, iCon)
{
	LookForNextConditionNextBoxFilterTableFound=0;
	return LookForNextConditionNextBoxFilterTable(elem, iCon);
}

//DOwn button
var LookForNextConditionNextBoxFilterTableFound;
function LookForNextConditionNextBoxFilterTable(elem, iCon)
{
	var next;
	if (typeof elem === "object")
	{
		for (var i=0; i<elem.elems.length; i++){
			next=LookForNextConditionNextBoxFilterTable(elem.elems[i], iCon);
			if (-1!=next)
				return next;
			if (LookForNextConditionNextBoxFilterTableFound==1){
				LookForNextConditionNextBoxFilterTableFound=2;
				break;
			}
		}
	}
	else
	{
		if (elem==iCon)
			LookForNextConditionNextBoxFilterTableFound=1;
		else if (LookForNextConditionNextBoxFilterTableFound!=0)
			return elem;
	}
	return -1;
}

function GiveNextConditionFilterTable(elem, iCon)
{
	LookForNextConditionFilterTableFound=false;
	return LookForNextConditionFilterTable(elem, iCon);
}
 

var LookForNextConditionFilterTableFound;
function LookForNextConditionFilterTable(elem, iCon)
{
	var next;
	if (typeof elem === "object")
	{
		for (var i=0; i<elem.elems.length; i++){
			next=LookForNextConditionFilterTable(elem.elems[i], iCon);
			if (-1!=next)
				return next;
		}
	}
	else
	{
		if (elem==iCon)
			LookForNextConditionFilterTableFound=true;
		else if (LookForNextConditionFilterTableFound)
			return elem;
	}
	return -1;
}

function MoveUpFilterCondition(iCon)
{
	alert(GivePreviousConditionFilterTable(elemFilter, iCon));
}

function GivePreviousConditionFilterTable(elem, iCon)
{
	LookForPreviousConditionFilterTableFound=false;
	return LookForPreviousConditionFilterTable(elem, iCon);
}

//up button
var LookForPreviousConditionFilterTableFound; 
function LookForPreviousConditionFilterTable(elem, iCon)
{
	var prev;
	if (typeof elem === "object")
	{
		for (var i=elem.elems.length-1; i>=0; i--){
			prev=LookForPreviousConditionFilterTable(elem.elems[i], iCon);
			if (-1!=prev)
				return prev;
		}
	}
	else
	{
		if (elem==iCon)
			LookForPreviousConditionFilterTableFound=true;
		else if (LookForPreviousConditionFilterTableFound)
			return elem;
	}
	return -1;
}

function GetFilterCondition(elem)
{
	return conditionsFilter[elem].property + '<button onClick="MoveDownFilterCondition(' + elem + ')">Down</button> <button onClick="MoveUpFilterCondition(' + elem + ')">Up</button>';
}

function GetFilterTable(elem) //COnstrucio taula //El segon, ser√† cridat per el ShowFilter
{
	var s='<table border="1"><tr><td>';
	if (typeof elem === "object")
	{
		for (var i=0; i<elem.elems.length; i++){  	
			s+=GetFilterTable(elem.elems[i]);
		}
		if (elem.elems.length<2 && elem.nexus)
			alert("Wrong encoding, an array of one condition cannot have a nexus. Autocorrected.");
		else if (elem.nexus)
			s+='</td><td valign="middle">'+elem.nexus;
	}
	else
		s+=GetFilterCondition(elem);
	s+='</td></tr></table>';
	return s;
}

function ShowFilterTable() //posar la taula on sigui //El que inicia la taula
{
	document.getElementById("tableFilter").innerHTML=GetFilterTable(elemFilter);
}

</script>
</head>
 <body ></body>
	<!--onLoad="ShowFilterTable();"> -->
<div id="tableFilter"></div>
<div>
	<table>
		<tr>
			<td></tr>
		</tr>
	</table>
</div>
</body>
</html>